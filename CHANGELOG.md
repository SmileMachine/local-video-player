# Change log

## TODO

Robustness:

1. 更多单元测试
2. 当不使用 cache 的时候，不进行统计。
3. 支持不统计视频时长。
4. 进度条功能检查

## 2024-11-06

- 支持 DPlayer 和 Plyr 播放器
- 使用适配器模式，播放器与视频信息解耦，便于切换

## 2024-11-05

- 优化了进度条的逻辑
- 重构了视频文件扫描和视频信息获取，减少重复扫描
- 添加了单元测试

## 2024-11-04

- 修改前端结构，拆分为不同模块，便于维护
- 简化前端代码，添加注释
- 添加快捷键
  - PageUp, PageDown 切换视频
- 记住上次播放的视频，对于每个视频，记录上次播放位置
- 自动加载字幕 (同目录下，同名 srt 或 vtt 文件)
- 修改 favicon
- 添加视频展开/收起动画

## 2024-11-03

- 完善注释，代码更易读。
- 编写 README，项目更易用。
- 优化视频时长的获取。
  - 使用 npm 包 `fluent-ffmpeg` 获取视频时长。
  - 缓存视频时长，速度提升 15 倍。
- 优化 api 返回数据
  - 返回视频信息中，已经提前计算好视频时长、大小等，无需客户端二次计算。
- 数据安全：
  - 不向客户端暴露视频路径。
  - 不能通过视频绝对路径请求文件，只能使用请求视频 ID。

## 2024-11-02

- 完成了基本的前后端
  - 后端提供视频服务，包括获取视频列表、视频时长，视频流
  - 前端播放视频，左边是视频列表，右边是视频播放
